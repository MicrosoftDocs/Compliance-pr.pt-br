---
title: Resiliência de dados do Exchange Online no Microsoft 365
description: Neste artigo, encontre uma explicação dos vários aspectos da resiliência de dados no Exchange Online e no Microsoft 365.
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
f1.keywords:
- NOCSH
ms.custom: seo-marvel-apr2020
titleSuffix: Microsoft Service Assurance
ms.openlocfilehash: 044bd637241c566a5e44df6522fca4dcab8b8534
ms.sourcegitcommit: 21ed42335efd37774ff5d17d9586d5546147241a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/05/2021
ms.locfileid: "50120520"
---
# <a name="exchange-online-data-resiliency-in-microsoft-365"></a><span data-ttu-id="a4b6f-103">Resiliência de dados do Exchange Online no Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="a4b6f-103">Exchange Online data resiliency in Microsoft 365</span></span>

>[!IMPORTANT]
><span data-ttu-id="a4b6f-104">À medida que continuamos investindo em maneiras diferentes de preservar o conteúdo da caixa de correio, anunciamos a ressarção do In-Place Holds no Centro de administração do Exchange (EAC) no Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-104">As we continue to invest in different ways to preserve mailbox content, we're announcing the retirement of In-Place Holds in the Exchange admin center (EAC) in Exchange Online.</span></span> <span data-ttu-id="a4b6f-105">A partir de 1º de julho de 2020, você não poderá criar novos In-Place Retém.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-105">Starting July 1, 2020, you won't be able to create new In-Place Holds.</span></span> <span data-ttu-id="a4b6f-106">Mas você ainda poderá gerenciar In-Place Retém no EAC ou usando o cmdlet **Set-MailboxSearch** no PowerShell do Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-106">But you'll still be able to manage In-Place Holds in the EAC or by using the **Set-MailboxSearch** cmdlet in Exchange Online PowerShell.</span></span> <span data-ttu-id="a4b6f-107">No entanto, a partir de 1º de outubro de 2020, você não poderá gerenciar o In-Place Retém.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-107">However, starting October 1, 2020, you won't be able to manage In-Place Holds.</span></span> <span data-ttu-id="a4b6f-108">Você só poderá removê-los no EAC ou usando o cmdlet **Remove-MailboxSearch.**</span><span class="sxs-lookup"><span data-stu-id="a4b6f-108">You'll only be able to remove them in the EAC or by using the **Remove-MailboxSearch** cmdlet.</span></span> <span data-ttu-id="a4b6f-109">Ainda haverá suporte para In-Place Respaldados no Exchange Server e em implantações híbridas do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-109">Using In-Place Holds in Exchange Server and Exchange hybrid deployments will still be supported.</span></span> <span data-ttu-id="a4b6f-110">For more information about the retirement of In-Place Holds in Exchange Online, see [Retirement of legacy eDiscovery tools](/microsoft-365/compliance/legacy-ediscovery-retirement).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-110">For more information about the retirement of In-Place Holds in Exchange Online, see [Retirement of legacy eDiscovery tools](/microsoft-365/compliance/legacy-ediscovery-retirement).</span></span>

<span data-ttu-id="a4b6f-111">Um In-Place preserva todo o conteúdo da caixa de correio, incluindo itens excluídos e versões originais de itens modificados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-111">An In-Place Hold preserves all mailbox content, including deleted items and original versions of modified items.</span></span> <span data-ttu-id="a4b6f-112">Todos os itens da caixa de correio são retornados em uma pesquisa de [Descoberta eletrônica In-loco](/exchange/security-and-compliance/in-place-ediscovery/in-place-ediscovery).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-112">All such mailbox items are returned in an [In-Place eDiscovery](/exchange/security-and-compliance/in-place-ediscovery/in-place-ediscovery) search.</span></span> <span data-ttu-id="a4b6f-113">Quando você coloca um In-Place de correio de um usuário, o conteúdo na caixa de correio de arquivo morto correspondente (se estiver habilitada) também é colocado em espera e retornado em uma pesquisa de Descoberta Eletrônico.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-113">When you place an In-Place Hold on a user's mailbox, the contents in the corresponding archive mailbox (if it's enabled) are also placed on hold and returned in an eDiscovery search.</span></span>

<span data-ttu-id="a4b6f-114">Há dois tipos de corrupção que podem afetar um banco de dados do Exchange: corrupção física, que normalmente é causada por problemas de hardware (em particular, hardware de armazenamento) e dano lógico, que ocorre devido a outros fatores.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-114">There are two types of corruption that can affect an Exchange database: physical corruption, which is typically caused by hardware (in particular, storage hardware) problems, and logical corruption, which occurs due to other factors.</span></span> <span data-ttu-id="a4b6f-115">Geralmente, há dois tipos de corrupção lógica que podem ocorrer em um banco de dados do Exchange:</span><span class="sxs-lookup"><span data-stu-id="a4b6f-115">Generally, there are two types of logical corruption that can occur within an Exchange database:</span></span>

- <span data-ttu-id="a4b6f-116">**Corrupção lógica do banco de** dados - A verificação da página do banco de dados corresponde, mas os dados na página estão errados logicamente.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-116">**Database logical corruption** - The database page checksum matches, but the data on the page is wrong logically.</span></span> <span data-ttu-id="a4b6f-117">Isso pode ocorrer quando o mecanismo de banco de dados (o Mecanismo de Armazenamento Extensível (ESE)) tenta gravar uma página de banco de dados e, mesmo que o sistema operacional retorne uma mensagem de sucesso, os dados nunca são gravados no disco ou são gravados no lugar errado.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-117">This can occur when the database engine (the Extensible Storage Engine (ESE)) attempts to write a database page and even though the operating system returns a success message, the data is either never written to the disk or it's written to the wrong place.</span></span> <span data-ttu-id="a4b6f-118">Isso é conhecido como *liberação perdida*.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-118">This is referred to as a *lost flush*.</span></span> <span data-ttu-id="a4b6f-119">O ESE inclui vários recursos e proteções projetados para evitar a corrupção física de um banco de dados e outros cenários de perda de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-119">ESE includes numerous features and safeguards that are designed to prevent physical corruption of a database and other data loss scenarios.</span></span> <span data-ttu-id="a4b6f-120">Para evitar que liberações perdidas percam dados, o ESE inclui um mecanismo de detecção de liberação perdida no banco de dados juntamente com um recurso (restauração de página única) para corrigi-lo.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-120">To prevent lost flushes from losing data, ESE includes a lost flush detection mechanism in the database along with a feature (single page restore) to correct it.</span></span>
- <span data-ttu-id="a4b6f-121">**Armazenar danos lógicos** - Os dados são adicionados, excluídos ou manipulados de uma maneira que o usuário não espera.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-121">**Store logical corruption** - Data is added, deleted, or manipulated in a way that the user doesn't expect.</span></span> <span data-ttu-id="a4b6f-122">Esses casos são causados por aplicativos de terceiros.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-122">These cases are caused by third-party applications.</span></span> <span data-ttu-id="a4b6f-123">Geralmente, é corrupção no sentido de que o usuário o vê como corrupção.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-123">It's usually corruption in the sense that the user views it as corruption.</span></span> <span data-ttu-id="a4b6f-124">O repositório do Exchange considera a transação que produziu o dano lógico uma série de operações MAPI válidas.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-124">The Exchange store considers the transaction that produced the logical corruption to be a series of valid MAPI operations.</span></span> <span data-ttu-id="a4b6f-125">Os [recursos de](/exchange/security-and-compliance/create-or-remove-in-place-holds) Reter Local no Exchange Online oferece proteção contra corrupção lógica do armazenamento (porque impede que o conteúdo seja excluído permanentemente por um usuário ou um aplicativo).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-125">The [In-Place Hold](/exchange/security-and-compliance/create-or-remove-in-place-holds) features in Exchange Online provides protection from store logical corruption (because it prevents content from being permanently deleted by a user or an application).</span></span> 

<span data-ttu-id="a4b6f-126">O Exchange Online realiza várias verificações de consistência nos arquivos de log replicados durante a inspeção de log e a repetição de log.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-126">Exchange Online performs several consistency checks on replicated log files during both log inspection and log replay.</span></span> <span data-ttu-id="a4b6f-127">Essas verificações de consistência impedem que a corrupção física seja replicada pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-127">These consistency checks prevent physical corruption from being replicated by the system.</span></span> <span data-ttu-id="a4b6f-128">Por exemplo, durante a inspeção de log, há uma verificação de integridade física que verifica o arquivo de log e valida que a verificação registrada no arquivo de log corresponde à verificação gerada na memória.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-128">For example, during log inspection, there is a physical integrity check that verifies the log file and validates that the checksum recorded in the log file matches the checksum generated in memory.</span></span> <span data-ttu-id="a4b6f-129">Além disso, o header do arquivo de log é examinado para garantir que a assinatura do arquivo de log registrada no header do log corresponde à do arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-129">In addition, the log file header is examined to make sure the log file signature recorded in the log header matches that of the log file.</span></span> <span data-ttu-id="a4b6f-130">Durante a repetição do log, o arquivo de log passa por mais exames.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-130">During log replay, the log file undergoes further scrutiny.</span></span> <span data-ttu-id="a4b6f-131">Por exemplo, o header do banco de dados também contém a assinatura de log que é comparada com a assinatura do arquivo de log para garantir que eles se matchm.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-131">For example, the database header also contains the log signature that is compared with the log file's signature to ensure they match.</span></span> 

<span data-ttu-id="a4b6f-132">A proteção contra corrupção de dados de caixa de correio no Exchange Online é alcançada usando a Proteção de Dados Nativa do Exchange, uma estratégia de resiliência que aproveita a replicação no nível do aplicativo em vários servidores e vários datacenters, juntamente com outros recursos que ajudam a proteger os dados contra perda devido a corrupção ou outros motivos.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-132">Protection against corruption of mailbox data in Exchange Online is achieved by using Exchange Native Data Protection, a resiliency strategy that leverages application-level replication across multiple servers and multiple datacenters along with other features that help protect data from being lost due to corruption or other reasons.</span></span> <span data-ttu-id="a4b6f-133">Esses recursos incluem recursos nativos gerenciados pela Microsoft ou pelo próprio aplicativo do Exchange Online, como:</span><span class="sxs-lookup"><span data-stu-id="a4b6f-133">These features include native features that are managed by Microsoft or the Exchange Online application itself, such as:</span></span>

- [<span data-ttu-id="a4b6f-134">Grupos de Disponibilidade de Dados</span><span class="sxs-lookup"><span data-stu-id="a4b6f-134">Data Availability Groups</span></span>](/exchange/back-up-email)
- <span data-ttu-id="a4b6f-135">Correção de bit único</span><span class="sxs-lookup"><span data-stu-id="a4b6f-135">Single Bit Correction</span></span> 
- <span data-ttu-id="a4b6f-136">Verificação de banco de dados online</span><span class="sxs-lookup"><span data-stu-id="a4b6f-136">Online Database Scanning</span></span> 
- <span data-ttu-id="a4b6f-137">Detecção de Liberação Perdida</span><span class="sxs-lookup"><span data-stu-id="a4b6f-137">Lost Flush Detection</span></span> 
- <span data-ttu-id="a4b6f-138">Restauração de página única</span><span class="sxs-lookup"><span data-stu-id="a4b6f-138">Single Page Restore</span></span> 
- <span data-ttu-id="a4b6f-139">Serviço de Replicação de Caixa de Correio</span><span class="sxs-lookup"><span data-stu-id="a4b6f-139">Mailbox Replication Service</span></span> 
- <span data-ttu-id="a4b6f-140">Verificações do arquivo de log</span><span class="sxs-lookup"><span data-stu-id="a4b6f-140">Log File Checks</span></span> 
- <span data-ttu-id="a4b6f-141">Implantação em sistema de arquivos resiliente</span><span class="sxs-lookup"><span data-stu-id="a4b6f-141">Deployment on Resilient File System</span></span> 

<span data-ttu-id="a4b6f-142">Para obter mais informações sobre os recursos nativos listados anteriormente, selecione os hiperlinks e consulte o seguinte para obter informações adicionais e para obter detalhes sobre itens sem hiperlinks.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-142">For more information on the native features listed previously, select the hyperlinks, and see the following for additional information and for details on items without hyperlinks.</span></span> <span data-ttu-id="a4b6f-143">Além desses recursos nativos, o Exchange Online também inclui recursos de resiliência de dados que os clientes podem gerenciar, como:</span><span class="sxs-lookup"><span data-stu-id="a4b6f-143">In addition to these native features, Exchange Online also includes data resiliency features that customers can manage, such as:</span></span> 
- [<span data-ttu-id="a4b6f-144">Recuperação de Item Único (habilitada por padrão)</span><span class="sxs-lookup"><span data-stu-id="a4b6f-144">Single Item Recovery (enabled by default)</span></span>](/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [<span data-ttu-id="a4b6f-145">Bloqueio In-loco e Retenção de Litígio</span><span class="sxs-lookup"><span data-stu-id="a4b6f-145">In-Place Hold and Litigation Hold</span></span>](/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [<span data-ttu-id="a4b6f-146">Caixas de correio de retenção e Soft-Deleted itens excluídos (ambas habilitadas por padrão)</span><span class="sxs-lookup"><span data-stu-id="a4b6f-146">Deleted Item Retention and Soft-Deleted Mailboxes (both enabled by default)</span></span>](/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a><span data-ttu-id="a4b6f-147">Grupos de Disponibilidade de Banco de Dados</span><span class="sxs-lookup"><span data-stu-id="a4b6f-147">Database Availability Groups</span></span> 
<span data-ttu-id="a4b6f-148">Cada banco de dados de caixa de correio no Microsoft 365 é hospedado em um grupo de disponibilidade de banco de dados [(DAG)](/exchange/back-up-email) e replicado para datacenters geograficamente separados dentro da mesma região.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-148">Every mailbox database in Microsoft 365 is hosted in a [database availability group (DAG)](/exchange/back-up-email) and replicated to geographically separate datacenters within the same region.</span></span> <span data-ttu-id="a4b6f-149">A configuração mais comum é quatro cópias de banco de dados em quatro datacenters; No entanto, algumas regiões têm menos datacenters (os bancos de dados são replicados para três datacenters na Índia e dois datacenters na Austrália e no Japão).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-149">The most common configuration is four database copies in four datacenters; however, some regions have fewer datacenters (databases are replicated to three datacenters in India, and two datacenters in Australia and Japan).</span></span> <span data-ttu-id="a4b6f-150">Mas, em todos os casos, cada banco de dados de caixa de correio tem quatro cópias distribuídas em vários datacenters, garantindo assim que os dados da caixa de correio sejam protegidos contra falhas de software, hardware e até mesmo datacenter.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-150">But in all cases, every mailbox database has four copies that are distributed across multiple datacenters, thereby ensuring that mailbox data is protected from software, hardware, and even datacenter failures.</span></span> 

<span data-ttu-id="a4b6f-151">Dessas quatro cópias, três delas estão configuradas como altamente disponíveis.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-151">Out of these four copies, three of them are configured as highly available.</span></span> <span data-ttu-id="a4b6f-152">A quarta cópia é configurada como uma cópia [de banco de dados com tempo.](/Exchange/high-availability/manage-ha/activate-lagged-db-copies)</span><span class="sxs-lookup"><span data-stu-id="a4b6f-152">The fourth copy is configured as a [lagged database copy](/Exchange/high-availability/manage-ha/activate-lagged-db-copies).</span></span> <span data-ttu-id="a4b6f-153">A cópia de banco de dados com tempo não se destina à recuperação de caixa de correio individual ou à recuperação de item de caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-153">The lagged database copy is not intended for individual mailbox recovery or mailbox item recovery.</span></span> <span data-ttu-id="a4b6f-154">Seu objetivo é fornecer um mecanismo de recuperação para o raro evento de corrupção lógica catastrófica em todo o sistema.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-154">Its purpose is to provide a recovery mechanism for the rare event of system-wide, catastrophic logical corruption.</span></span> 

<span data-ttu-id="a4b6f-155">As cópias de banco de dados com retardo no Exchange Online são configuradas com um tempo de retardo de repetição do arquivo de log de sete dias.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-155">Lagged database copies in Exchange Online are configured with a seven-day log file replay lag time.</span></span> <span data-ttu-id="a4b6f-156">Além disso, o Gerenciador de Retardo de Repetição do Exchange está habilitado para fornecer o arquivo de log dinâmico para cópias com retardo a fim de permitir que as cópias de banco de dados com retardo reparem e gerenciem o crescimento do arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-156">In addition, the Exchange Replay Lag Manager is enabled to provide dynamic log file play down for lagged copies to allow lagged database copies to self-repair and manage log file growth.</span></span> <span data-ttu-id="a4b6f-157">Embora as cópias de banco de dados comfaçadas sejam usadas no Exchange Online, é importante entender que elas não são um backup de ponto no tempo garantido.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-157">Although lagged database copies are used in Exchange Online, it is important to understand that they are not a guaranteed point-in-time backup.</span></span> <span data-ttu-id="a4b6f-158">As cópias de banco de dados com problemas no Exchange Online têm um limite de disponibilidade, geralmente em torno de 90%, devido aos períodos em que o disco que contém uma cópia com tempo é perdido devido a uma falha de disco, a cópia comfasagem se torna uma cópia altamente disponível (devido à reprodução automática), bem como os períodos em que a cópia de banco de dados com tempo está recriando a fila de repetição do log.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-158">Lagged database copies in Exchange Online have an availability threshold, typically around 90%, due to periods where the disk containing a lagged copy is lost due to disk failure, the lagged copy becoming a highly available copy (due to automatic play down), as well as the periods where the lagged database copy is rebuilding the log replay queue.</span></span> 

## <a name="transport-resilience"></a><span data-ttu-id="a4b6f-159">Resiliência de transporte</span><span class="sxs-lookup"><span data-stu-id="a4b6f-159">Transport Resilience</span></span> 
<span data-ttu-id="a4b6f-160">O Exchange Online inclui dois recursos principais de resiliência de transporte: Redundância de Sombra e Rede De Segurança.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-160">Exchange Online includes two primary transport resilience features: Shadow Redundancy and Safety Net.</span></span> <span data-ttu-id="a4b6f-161">A Redundância de Sombra mantém uma cópia redundante de uma mensagem enquanto ela está em trânsito.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-161">Shadow Redundancy keeps a redundant copy of a message while it is in transit.</span></span> <span data-ttu-id="a4b6f-162">A Rede Segura mantém uma cópia redundante de uma mensagem após a entrega bem-sucedida da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-162">Safety Net keeps a redundant copy of a message after the message is successfully delivered.</span></span> 

<span data-ttu-id="a4b6f-163">Com a Redundância de Sombra, cada servidor de transporte do Exchange Online faz uma cópia de cada mensagem que recebe antes de confirmar o recebimento bem-sucedido da mensagem para o servidor de envio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-163">With Shadow Redundancy, each Exchange Online transport server makes a copy of each message it receives before it acknowledges successfully receiving the message to the sending server.</span></span> <span data-ttu-id="a4b6f-164">Isso torna redundantes todas as mensagens no pipeline de transporte em trânsito.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-164">This makes all messages in the transport pipeline redundant while in transit.</span></span> <span data-ttu-id="a4b6f-165">Se o Exchange Online determinar que a mensagem original foi perdida em trânsito, uma cópia redundante da mensagem será entregue outra vez.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-165">If Exchange Online determines the original message was lost in transit, a redundant copy of the message is redelivered.</span></span> 

<span data-ttu-id="a4b6f-166">Rede Segura é uma fila de transporte associada ao serviço de Transporte em um servidor de Caixa de Correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-166">Safety Net is a transport queue that is associated with the Transport service on a Mailbox server.</span></span> <span data-ttu-id="a4b6f-167">Essa fila armazena cópias de mensagens que foram processadas com êxito pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-167">This queue stores copies of messages that were successfully processed by the server.</span></span> <span data-ttu-id="a4b6f-168">Quando um banco de dados de caixa de correio ou uma falha de servidor exige a ativação de uma cópia des date do banco de dados de caixa de correio, as mensagens na fila rede de segurança são automaticamente retransmitidas para a nova cópia ativa do banco de dados de caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-168">When a mailbox database or server failure requires activating an out-of-date copy of the mailbox database, messages in the Safety Net queue are automatically resubmitted to the new active copy of the mailbox database.</span></span> <span data-ttu-id="a4b6f-169">A Rede Segura também é redundante, eliminando o transporte como um único ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-169">Safety Net is also redundant, thereby eliminating transport as a single point of failure.</span></span> <span data-ttu-id="a4b6f-170">Ele usa o conceito de uma Rede de Segurança Primária e uma Rede de Segurança de Sombra, em que, se a Rede De Segurança Primária não estiver disponível por mais de 12 horas, as solicitações de reenviação se tornarão solicitações de reenviação de sombra e as mensagens serão entregues de volta da Rede De Segurança de Sombra.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-170">It uses the concept of a Primary Safety Net and a Shadow Safety Net wherein if the Primary Safety Net is unavailable for more than 12 hours, resubmit requests become shadow resubmit requests, and messages are redelivered from the Shadow Safety Net.</span></span>

<span data-ttu-id="a4b6f-171">As reenviações de mensagens da Rede Segura são iniciadas automaticamente pelo componente Active Manager do serviço de Replicação do Microsoft Exchange que gerencia DAGs e cópias de banco de dados de caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-171">Message resubmissions from Safety Net are automatically initiated by the Active Manager component of the Microsoft Exchange Replication service that manages DAGs and mailbox database copies.</span></span> <span data-ttu-id="a4b6f-172">Nenhuma ação manual é necessária para remmitir mensagens da Rede Segura.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-172">No manual actions are required to resubmit messages from Safety Net.</span></span> 

## <a name="single-bit-correction"></a><span data-ttu-id="a4b6f-173">Correção de bit único</span><span class="sxs-lookup"><span data-stu-id="a4b6f-173">Single Bit Correction</span></span> 
<span data-ttu-id="a4b6f-174">O ESE inclui um mecanismo para detectar e resolver erros de CRC de bit único (também conhecidos como invasões de bit único) que são o resultado de erros de hardware (e, como tal, representam corrupção física).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-174">ESE includes a mechanism to detect and resolve single-bit CRC errors (also known as single-bit flips) that are the result of hardware errors (and as such they represent physical corruption).</span></span> <span data-ttu-id="a4b6f-175">Quando esses erros ocorrem, o ESE os corrige automaticamente e registra um evento no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-175">When these errors occur, ESE automatically corrects them and logs an event in the event log.</span></span> 

## <a name="online-database-scanning"></a><span data-ttu-id="a4b6f-176">Verificação de banco de dados online</span><span class="sxs-lookup"><span data-stu-id="a4b6f-176">Online Database Scanning</span></span> 
<span data-ttu-id="a4b6f-177">A verificação de banco de dados online (também conhecida como somatório de verificação de banco de *dados)* é o processo em que um ESE usa um verificador de consistência de banco de dados para ler cada página e verificar se há corrupção de página.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-177">Online database scanning (also known as *database check summing*) is the process where an ESE uses a database consistency checker to read each page and check for page corruption.</span></span> <span data-ttu-id="a4b6f-178">O objetivo principal é detectar danos físicos e liberações perdidas que podem não estar sendo detectadas por operações transacionais.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-178">The primary purpose is to detect physical corruption and lost flushes that may not be getting detected by transactional operations.</span></span> <span data-ttu-id="a4b6f-179">A verificação de banco de dados também executa operações de falha pós-armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-179">Database scanning also performs post-store crash operations.</span></span> <span data-ttu-id="a4b6f-180">O espaço pode ser vazado devido a falhas e a verificação de banco de dados online localiza e recupera espaço perdido.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-180">Space can be leaked due to crashes, and online database scanning finds and recovers lost space.</span></span> <span data-ttu-id="a4b6f-181">O sistema é projetado com a expectativa de que todos os bancos de dados são totalmente verificados uma vez a cada sete dias.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-181">The system is designed with the expectation that every database is fully scanned once every seven days.</span></span> 

## <a name="lost-flush-detection"></a><span data-ttu-id="a4b6f-182">Detecção de liberação perdida</span><span class="sxs-lookup"><span data-stu-id="a4b6f-182">Lost Flush Detection</span></span> 
<span data-ttu-id="a4b6f-183">Uma liberação perdida ocorre quando uma operação de gravação de banco de dados que o subsistema/sistema operacional de disco retornado como concluído não foi realmente gravado no disco ou foi escrita no local errado.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-183">A lost flush occurs when a database write operation that the disk subsystem/operating system returned as completed did not actually get written to disk, or was written in the wrong location.</span></span> <span data-ttu-id="a4b6f-184">Os incidentes de liberação perdida podem resultar em corrupção lógica do banco de dados, portanto, para evitar que liberações perdidas resultem em dados perdidos, o ESE inclui um mecanismo de detecção de liberação perdida.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-184">Lost flush incidents can result in database logical corruption, so to prevent lost flushes from resulting in lost data, ESE includes a lost flush detection mechanism.</span></span> <span data-ttu-id="a4b6f-185">À medida que as páginas de banco de dados são escritas em cópias passivas, uma verificação é realizada para liberações perdidas na cópia ativa.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-185">As database pages are written to passive copies, a check is performed for lost flushes on the active copy.</span></span> <span data-ttu-id="a4b6f-186">Se uma liberação perdida for detectada, o ESE poderá reparar o processo usando um processo de correção de página.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-186">If a lost flush is detected, ESE can repair the process using a page patching process.</span></span> 

## <a name="single-page-restore"></a><span data-ttu-id="a4b6f-187">Restauração de página única</span><span class="sxs-lookup"><span data-stu-id="a4b6f-187">Single Page Restore</span></span> 
<span data-ttu-id="a4b6f-188">A restauração de página única, também conhecida como correção de *página,* é um processo automático em que as páginas corrompidas do banco de dados são substituídas por cópias saudável de uma réplica saudável.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-188">Single page restore, also known as *page patching*, is an automatic process where corrupt database pages are replaced by healthy copies from a healthy replica.</span></span> <span data-ttu-id="a4b6f-189">O processo de reparo de uma página corrompida depende de a cópia do banco de dados ser ativa ou passiva.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-189">The repair process for a corrupt page depends on whether the database copy is active or passive.</span></span> <span data-ttu-id="a4b6f-190">Quando uma cópia de banco de dados ativa encontra uma página corrompida, ela pode copiar uma página de uma de suas réplicas, desde que a página que copia está atualizada.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-190">When an active database copy encounters a corrupted page, it can copy a page from one of its replicas, provided the page it copies is up to date.</span></span> <span data-ttu-id="a4b6f-191">Esse processo é realizado colocando uma solicitação para a página no fluxo de log, que é a base da replicação de banco de dados de caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-191">This process is accomplished by putting a request for the page into the log stream, which is the basis of mailbox database replication.</span></span> <span data-ttu-id="a4b6f-192">Assim que uma réplica encontra a solicitação de página, ela responde enviando uma cópia da página para a cópia do banco de dados solicitante.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-192">As soon as a replica encounters the page request, it responds by sending a copy of the page to the requesting database copy.</span></span> <span data-ttu-id="a4b6f-193">A restauração de página única também fornece um mecanismo de comunicação assíncrona para que o ativo solicite uma página de réplicas, mesmo se as réplicas estão offline no momento.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-193">Single page restore also provides an asynchronous communication mechanism for the active to request a page from replicas, even if the replicas are currently offline.</span></span> 

<span data-ttu-id="a4b6f-194">Em caso de corrupção em uma cópia de banco de dados passiva, incluindo uma cópia de banco de dados com atraso, como essas cópias estão sempre atrás de sua cópia ativa, é sempre seguro copiar qualquer página da cópia ativa para uma cópia passiva.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-194">In case of corruption in a passive database copy, including a lagged database copy, because these copies are always behind their active copy, it is always safe to copy any page from the active copy to a passive copy.</span></span> <span data-ttu-id="a4b6f-195">Uma cópia de banco de dados passiva é, por natureza, altamente disponível, portanto, durante o processo de correção de página, a reprodução de log é suspensa, mas a cópia de log continua.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-195">A passive database copy is by nature highly available, so during the page patching process, log replaying is suspended, but log copying continues.</span></span> <span data-ttu-id="a4b6f-196">A cópia passiva do banco de dados recupera uma cópia da página corrompida da cópia ativa, aguarda até que o arquivo de log que atenda ao requisito máximo de geração de log necessário seja copiado e inspecionado e, em seguida, correção da página corrompida.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-196">The passive database copy retrieves a copy of the corrupted page from the active copy, waits until the log file that meets the maximum required log generation requirement is copied and inspected, and then patches the corrupt page.</span></span> <span data-ttu-id="a4b6f-197">Depois que a página tiver sido corrigida, a repetição de log será retomada.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-197">Once the page has been patched, log replay resumes.</span></span> <span data-ttu-id="a4b6f-198">O processo é o mesmo para a cópia de banco de dados com tempo, exceto pelo fato de que o banco de dados com tempo defasado primeiro reproduz todos os arquivos de log necessários para alcançar um estado a patches.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-198">The process is the same for the lagged database copy, except that the lagged database first replays all log files that are necessary to achieve a patchable state.</span></span> 

## <a name="mailbox-replication-service"></a><span data-ttu-id="a4b6f-199">Serviço de Replicação de Caixa de Correio</span><span class="sxs-lookup"><span data-stu-id="a4b6f-199">Mailbox Replication Service</span></span> 
<span data-ttu-id="a4b6f-200">Mover caixas de correio é uma parte importante do gerenciamento de um serviço de email em grande escala.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-200">Moving mailboxes is a key part of managing a large-scale email service.</span></span> <span data-ttu-id="a4b6f-201">Sempre há tecnologias atualizadas e atualizações de hardware e versão para lidar, portanto, ter um sistema robusto e acelerador que permite que nossos engenheiros realizem esse trabalho, mantendo a caixa de correio transparente para os usuários (ao garantir que eles permaneçam online durante todo o processo) é fundamental e garantir que o processo seja ampliado normalmente à medida que as caixas de correio ficam maiores e maiores.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-201">There are always updated technologies and hardware and version upgrades to deal with, so having a robust, throttled system that enables our engineers to accomplish this work while keeping the mailbox moves transparent to users (by making sure they stay online throughout the process) is key and making sure that the process scales up gracefully as mailboxes get larger and larger.</span></span> 

<span data-ttu-id="a4b6f-202">O Serviço de Replicação de Caixa de Correio do Exchange (MRS) é responsável por mover caixas de correio entre bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-202">The Exchange Mailbox Replication Service (MRS) is responsible for moving mailboxes between databases.</span></span> <span data-ttu-id="a4b6f-203">Durante a movimentação, o MRS realiza uma verificação de consistência em todos os itens da caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-203">During the move, MRS performs a consistency check on all items within the mailbox.</span></span> <span data-ttu-id="a4b6f-204">Se for encontrado um problema de consistência, o MRS corrigirá o problema ou ignorará os itens corrompidos, removendo, assim, a corrupção da caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-204">If a consistency issue is found, MRS will either correct the problem, or skip the corrupted items, thereby removing the corruption from the mailbox.</span></span> 

<span data-ttu-id="a4b6f-205">Como o MRS é um componente do Exchange Online, podemos fazer alterações em seu código para lidar com novas formas de corrupção detectadas no futuro.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-205">Because MRS is a component of Exchange Online, we can make changes in its code to address new forms of corruption that are detected in the future.</span></span> <span data-ttu-id="a4b6f-206">Por exemplo, se detectarmos um problema de consistência que o MRS não consegue corrigir, podemos analisar a corrupção, alterar o código MRS e corrigir a inconsistência (se entendermos como fazer).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-206">For example, if we detect a consistency issue that MRS is not able to fix, we can analyze the corruption, change the MRS code and correct the inconsistency (if we understand how to).</span></span> 

## <a name="log-file-checks"></a><span data-ttu-id="a4b6f-207">Verificações do arquivo de log</span><span class="sxs-lookup"><span data-stu-id="a4b6f-207">Log File Checks</span></span> 
<span data-ttu-id="a4b6f-208">Todos os arquivos de log de transações gerados por um banco de dados do Exchange passam por várias formas de verificações de consistência.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-208">All transaction log files generated by an Exchange database undergo several forms of consistency checks.</span></span> <span data-ttu-id="a4b6f-209">Quando um arquivo de log é criado, a primeira coisa a fazer é um padrão de bits é gravado e, em seguida, uma série de gravações de log é executada.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-209">When a log file is created, the first thing done is a bit pattern is written and then a series of log writes is performed.</span></span> <span data-ttu-id="a4b6f-210">Essa estrutura permite que o Exchange Online execute uma série de verificações (liberação perdida, CRC e outras verificações) para validar cada arquivo de log conforme ele é gravado e novamente conforme é replicado.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-210">This structure enables Exchange Online to execute a series of checks (lost flush, CRC, and other checks) to validate each log file as it is written, and again as it is replicated.</span></span> 

## <a name="deployment-on-resilient-file-system"></a><span data-ttu-id="a4b6f-211">Implantação em sistema de arquivos resiliente</span><span class="sxs-lookup"><span data-stu-id="a4b6f-211">Deployment on Resilient File System</span></span> 
<span data-ttu-id="a4b6f-212">Para ajudar a evitar que a corrupção ocorra no nível do sistema de arquivos, o Exchange Online está sendo implantado em partições do Sistema de Arquivos Resiliente (ReFS) para fornecer recursos de recuperação aprimorados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-212">To help prevent corruption from occurring at the file system level, Exchange Online is being deployed on Resilient File System (ReFS) partitions to provide improved recovery capabilities.</span></span> <span data-ttu-id="a4b6f-213">O ReFS é um sistema de arquivos no Windows Server 2012 e posterior que foi projetado para ser mais resiliente contra corrupção de dados, maximizando a disponibilidade e a integridade dos dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-213">ReFS is a file system in Windows Server 2012 and later that is designed to be more resilient against data corruption thereby maximizing data availability and integrity.</span></span> <span data-ttu-id="a4b6f-214">Especificamente, o ReFS traz melhorias na maneira como os metadados são atualizados, o que oferece melhor proteção para dados e reduz os casos de corrupção de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-214">Specifically, ReFS brings improvements in the way that metadata is updated which offers better protection for data and reduces data corruption cases.</span></span> <span data-ttu-id="a4b6f-215">Ele também usa as verificações para verificar a integridade dos dados e metadados do arquivo, garantindo que os dados corrupções são facilmente encontrados e reparados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-215">It also uses checksums to verify the integrity of file data and metadata ensuring that data corruption is easily found and repaired.</span></span> 

<span data-ttu-id="a4b6f-216">O Exchange Online aproveita vários benefícios do ReFS:</span><span class="sxs-lookup"><span data-stu-id="a4b6f-216">Exchange Online takes advantage of several ReFS benefits:</span></span> 
- <span data-ttu-id="a4b6f-217">Mais resiliência na integridade de dados significa menos incidentes de corrupção de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-217">More resiliency in data integrity means fewer data corruption incidents.</span></span> <span data-ttu-id="a4b6f-218">Reduzir o número de incidentes de corrupção significa menos reações desnecessárias do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-218">Reducing the number of corruption incidents means fewer unnecessary database reseeds.</span></span> 
- <span data-ttu-id="a4b6f-219">A verificação em execução em metadados habilitando detecções de casos de corrupção mais cedo e mais deterministicamente, permitindo corrigir a corrupção de dados do cliente antes que ocorram falhas cinza nos volumes de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-219">Checksum running on metadata enabling detections of corruption cases sooner and more deterministically, allowing us to fix customer data corruption before grey failures occur on data volumes.</span></span>
- <span data-ttu-id="a4b6f-220">Projetado para funcionar bem com grandes conjuntos de dados — petabytes e maiores — sem impacto no desempenho</span><span class="sxs-lookup"><span data-stu-id="a4b6f-220">Designed to work well with large data sets—petabytes and larger—without performance impact</span></span>
- <span data-ttu-id="a4b6f-221">Suporte para outros recursos usados pelo Exchange Online, como criptografia BitLocker.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-221">Support for other features used by Exchange Online, such as BitLocker encryption.</span></span> 

<span data-ttu-id="a4b6f-222">O Exchange Online também se beneficia de outros recursos do ReFS:</span><span class="sxs-lookup"><span data-stu-id="a4b6f-222">Exchange Online also benefits from other ReFS features:</span></span> 
- <span data-ttu-id="a4b6f-223">**Integridade (Fluxos de Integridade)** – o ReFS armazena dados de maneira a protegê-los contra muitos dos erros comuns que normalmente podem causar perda de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-223">**Integrity (Integrity Streams)** - ReFS stores data in a way that protects it from many of the common errors that can normally cause data loss.</span></span> <span data-ttu-id="a4b6f-224">A Pesquisa do Microsoft 365 usa fluxos de integridade para ajudar com a detecção de corrupção de disco inicial e as verificações de conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-224">Microsoft 365 Search uses Integrity Streams to help with early disk corruption detection and checksums of file content.</span></span> <span data-ttu-id="a4b6f-225">O recurso também reduz os incidentes de corrupção causados por "Gravações de Filme" (quando uma operação de gravação não é concluída devido a falta de energia etc.).</span><span class="sxs-lookup"><span data-stu-id="a4b6f-225">The feature also reduces corruption incidents caused by “Torn Writes” (when a write operation does not complete due to power outages, etc.).</span></span> 
- <span data-ttu-id="a4b6f-226">**Disponibilidade (recuperação)** – o ReFS prioriza a disponibilidade de dados.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-226">**Availability (Salvage)** - ReFS prioritizes the availability of data.</span></span> <span data-ttu-id="a4b6f-227">Historicamente, os sistemas de arquivos eram frequentemente suscetíveis à corrupção de dados que exigia que o sistema fosse offline para reparo.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-227">Historically, file systems were often susceptible to data corruption that would require the system to be taken offline for repair.</span></span> <span data-ttu-id="a4b6f-228">Embora raro, se ocorrer corrupção, o ReFS implementa recuperação, um recurso que remove os dados corrompidos do namespace em um volume ao vivo e garante que os dados bons não sejam afetados negativamente por dados corrompidos não reparáveis.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-228">Although rare, if corruption does occur, ReFS implements salvage, a feature that removes the corrupt data from the namespace on a live volume and ensures that good data is not adversely affected by non-repairable corrupt data.</span></span> <span data-ttu-id="a4b6f-229">Aplicar o recurso Recuperação e isolar dados corrompidos nos volumes de banco de dados do Exchange Online significa que podemos manter íntepar bancos de dados não afetados em um volume corrompido entre o tempo de corrupção e ação de reparo.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-229">Applying the Salvage feature and isolating data corruption to Exchange Online database volumes means that we can keep non-affected databases on a corrupted volume healthy between the time of corruption and repair action.</span></span> <span data-ttu-id="a4b6f-230">Essa estrutura aumenta a disponibilidade de bancos de dados que normalmente seriam afetados por esses problemas de corrupção de disco.</span><span class="sxs-lookup"><span data-stu-id="a4b6f-230">This structure increases the availability of databases that would normally be affected by such disk corruption issues.</span></span> 
